function occamy(a,b,c){return this instanceof occamy?(this.doc=window&&window.document?window.document:c,this.container=a instanceof HTMLElement?a:this.doc.querySelector(a),this.opts=Object.assign({dir:null,prefix:"occamy",gap:0},b),"number"!=typeof this.opts.gap&&(this.opts.gap=parseInt(this.opts.gap,10)),this.style(),this[this.opts.dir||(this.container.offsetWidth/this.container.offsetHeight>1?"col":"row")]()):new occamy(a,b,c)}occamy.prototype.style=function(){var a=this.doc.createElement("style");return a.setAttribute("type","text/css"),a.setAttribute("media","screen"),a.setAttribute("id",this.opts.prefix+"-style"),a.appendChild(this.doc.createTextNode("")),this.doc.head.appendChild(a),a.sheet.insertRule("."+this.opts.prefix+"-item { display: block; position: absolute; overflow: hidden; transition: left 0.2s ease, top 0.2s ease; }",0),a.sheet.insertRule("."+this.opts.prefix+"-item > * { display: block; position: absolute; transform-origin: 50% 50%; transform: scale(0); transition: left 0.1s ease, top 0.1s ease, transform .2s ease; }",0),this.stylesheet=a,this},occamy.prototype.redraw=function(){return this.stylesheet||this.style(),this[this.opts.dir||(this.container.offsetWidth/this.container.offsetHeight>1?"col":"row")]()},occamy.prototype.destroy=function(){var a=this;return[].forEach.call(a.container.getElementsByClassName(a.opts.prefix+"-item"),function(a){["transform","left","top"].forEach(function(b){a.firstChild.style.removeProperty(b)})}),["item","group","container"].forEach(function(b){for(var c=a.container.getElementsByClassName(a.opts.prefix+"-"+b);c.length>0;)a.unwrap(c[0])}),this.stylesheet.parentNode.removeChild(this.stylesheet),this.stylesheet=null,this},occamy.prototype.wrap=function(a,b){var c=this.doc.createElement("div");return c.classList.add(b),a.parentNode.insertBefore(c,a),c.appendChild(a),this},occamy.prototype.unwrap=function(a){for(;a.firstChild;)a.parentNode.insertBefore(a.firstChild,a);return a.parentNode.removeChild(a),this},occamy.prototype.css=function(a,b){for(var c in b)a.style[c]=b[c];return this},occamy.prototype.col=function(){var a=this,b=!(a.container.getElementsByClassName(a.opts.prefix+"-item").length>0),c=b?Array.from(a.container.childNodes):Array.from(a.container.getElementsByClassName(a.opts.prefix+"-item")).reduce(function(a,b){return a.concat(Array.from(b.childNodes))},[]),d=a.container.offsetWidth-1,e=a.container.offsetHeight-1,f=e/d,g=c.reduce(function(a,b){return Math.max(a,b.offsetWidth)},-(1/0)),h=c.reduce(function(a,b){return a+b.offsetHeight*(g/b.offsetWidth)},0),i=g/(h/e),j=e,k=Math.max(1,function(){for(var a=0,b=1/0;100>a;a++){var c=Math.abs(f-j/a/(i*a));if(c>b)return--a;b=c}}());d-=a.opts.gap*(k-1);var l=Array(k).fill(null).map(function(a,b){return{num:b,height:0,items:[]}});c.sort(function(a,b){return a.offsetWidth/a.offsetHeight-b.offsetWidth/b.offsetHeight}).forEach(function(a){l=l.sort(function(a,b){return a.height-b.height}),l[0].height+=a.offsetHeight,l[0].items.push(a)}),l=l.map(function(a){return a.width=d/k,a.height=a.items.reduce(function(b,c){return b+c.offsetHeight*(a.width/c.offsetWidth)},0),a.width/=a.height/e,a.height=e,a});var m=l.reduce(function(a,b){return a+b.width},0),n=d/m,o=0;return l=l.map(function(c){c.width*=n,c.offset_x=o,c.offset_y=0,c.height=e-a.opts.gap*(c.items.length-1),c.scaleheight=c.items.reduce(function(a,b){return a+b.offsetHeight*(c.width/b.offsetWidth)},0),c.items.forEach(function(d){if(b){var e=a.doc.createElement("div");e.classList.add(a.opts.prefix+"-item"),d.parentNode.insertBefore(e,d),e.appendChild(d)}else var e=d.parentNode;var f=d.offsetHeight*(c.width/d.offsetWidth)*(c.height/c.scaleheight);a.css(e,{display:"block",position:"absolute",top:c.offset_y+"px",left:c.offset_x+"px",height:f+"px",width:c.width+"px"}),a.css(d,{transform:"scale("+Math.min(c.width/d.offsetWidth,f/d.offsetHeight)+")",left:(c.width-d.offsetWidth)/2+"px",top:(f-d.offsetHeight)/2+"px"}),c.offset_y+=f+a.opts.gap}),o+=c.width+a.opts.gap}),this},occamy.prototype.row=function(){var a=this,b=!(a.container.getElementsByClassName(a.opts.prefix+"-item").length>0),c=b?Array.from(a.container.childNodes):Array.from(a.container.getElementsByClassName(a.opts.prefix+"-item")).reduce(function(a,b){return a.concat(Array.from(b.childNodes))},[]),d=a.container.offsetWidth-1,e=a.container.offsetHeight-1,f=d/e,g=c.reduce(function(a,b){return Math.max(a,b.offsetHeight)},-(1/0)),h=c.reduce(function(a,b){return a+b.offsetWidth*(g/b.offsetHeight)},0),i=g/(h/d),j=d,k=Math.max(1,function(){for(var a=0,b=1/0;100>a;a++){var c=Math.abs(f-j/a/(i*a));if(c>b)return--a;b=c}}());e-=a.opts.gap*(k-1);var l=Array(k).fill(null).map(function(a,b){return{num:b,width:0,items:[]}});c.sort(function(a,b){return a.offsetHeight/a.offsetWidth-b.offsetHeight/b.offsetWidth}).forEach(function(a){l=l.sort(function(a,b){return a.width-b.width}),l[0].width+=a.offsetWidth,l[0].items.push(a)}),l=l.map(function(a){return a.height=e/k,a.width=a.items.reduce(function(b,c){return b+c.offsetWidth*(a.height/c.offsetHeight)},0),a.height/=a.width/d,a.width=d,a});var m=l.reduce(function(a,b){return a+b.height},0),n=e/m,o=0;return l=l.map(function(c){c.height*=n,c.offset_y=o,c.offset_x=0,c.width=d-a.opts.gap*(c.items.length-1),c.scalewidth=c.items.reduce(function(a,b){return a+b.offsetWidth*(c.height/b.offsetHeight)},0);return c.items.forEach(function(d){if(b){var e=a.doc.createElement("div");e.classList.add(a.opts.prefix+"-item"),d.parentNode.insertBefore(e,d),e.appendChild(d)}else var e=d.parentNode;var f=d.offsetWidth*(c.height/d.offsetHeight)*(c.width/c.scalewidth);a.css(e,{display:"block",position:"absolute",top:c.offset_y+"px",left:c.offset_x+"px",height:c.height+"px",width:f+"px"}),a.css(d,{transform:"scale("+Math.min(f/d.offsetWidth,c.height/d.offsetHeight)+")",left:(f-d.offsetWidth)/2+"px",top:(c.height-d.offsetHeight)/2+"px"}),c.offset_x+=f+a.opts.gap}),o+=c.height+a.opts.gap,c}),this},"undefined"!=typeof module&&module.exports&&(module.exports=occamy);